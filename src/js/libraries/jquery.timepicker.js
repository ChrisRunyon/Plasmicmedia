!function(factory){"object"==typeof exports&&exports&&"object"==typeof module&&module&&module.exports===exports?factory(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function($){function _isVisible(elem){var el=elem[0];return el.offsetWidth>0&&el.offsetHeight>0}function _parseSettings(settings){if(settings.minTime&&(settings.minTime=_time2int(settings.minTime)),settings.maxTime&&(settings.maxTime=_time2int(settings.maxTime)),settings.durationTime&&"function"!=typeof settings.durationTime&&(settings.durationTime=_time2int(settings.durationTime)),"now"==settings.scrollDefault)settings.scrollDefault=function(){return settings.roundingFunction(_time2int(new Date),settings)};else if(settings.scrollDefault&&"function"!=typeof settings.scrollDefault){var val=settings.scrollDefault;settings.scrollDefault=function(){return settings.roundingFunction(_time2int(val),settings)}}else settings.minTime&&(settings.scrollDefault=function(){return settings.roundingFunction(settings.minTime,settings)});if("string"===$.type(settings.timeFormat)&&settings.timeFormat.match(/[gh]/)&&(settings._twelveHourTime=!0),settings.showOnFocus===!1&&-1!=settings.showOn.indexOf("focus")&&settings.showOn.splice(settings.showOn.indexOf("focus"),1),settings.disableTimeRanges.length>0){for(var i in settings.disableTimeRanges)settings.disableTimeRanges[i]=[_time2int(settings.disableTimeRanges[i][0]),_time2int(settings.disableTimeRanges[i][1])];settings.disableTimeRanges=settings.disableTimeRanges.sort(function(a,b){return a[0]-b[0]});for(var i=settings.disableTimeRanges.length-1;i>0;i--)settings.disableTimeRanges[i][0]<=settings.disableTimeRanges[i-1][1]&&(settings.disableTimeRanges[i-1]=[Math.min(settings.disableTimeRanges[i][0],settings.disableTimeRanges[i-1][0]),Math.max(settings.disableTimeRanges[i][1],settings.disableTimeRanges[i-1][1])],settings.disableTimeRanges.splice(i,1))}return settings}function _render(self){var settings=self.data("timepicker-settings"),list=self.data("timepicker-list");if(list&&list.length&&(list.remove(),self.data("timepicker-list",!1)),settings.useSelect){list=$("<select />",{"class":"ui-timepicker-select"});var wrapped_list=list}else{list=$("<ul />",{"class":"ui-timepicker-list"});var wrapped_list=$("<div />",{"class":"ui-timepicker-wrapper",tabindex:-1});wrapped_list.css({display:"none",position:"absolute"}).append(list)}if(settings.noneOption)if(settings.noneOption===!0&&(settings.noneOption=settings.useSelect?"Time...":"None"),$.isArray(settings.noneOption)){for(var i in settings.noneOption)if(parseInt(i,10)==i){var noneElement=_generateNoneElement(settings.noneOption[i],settings.useSelect);list.append(noneElement)}}else{var noneElement=_generateNoneElement(settings.noneOption,settings.useSelect);list.append(noneElement)}if(settings.className&&wrapped_list.addClass(settings.className),(null!==settings.minTime||null!==settings.durationTime)&&settings.showDuration){"function"==typeof settings.step?"function":settings.step;wrapped_list.addClass("ui-timepicker-with-duration"),wrapped_list.addClass("ui-timepicker-step-"+settings.step)}var durStart=settings.minTime;"function"==typeof settings.durationTime?durStart=_time2int(settings.durationTime()):null!==settings.durationTime&&(durStart=settings.durationTime);var start=null!==settings.minTime?settings.minTime:0,end=null!==settings.maxTime?settings.maxTime:start+_ONE_DAY-1;start>end&&(end+=_ONE_DAY),end===_ONE_DAY-1&&"string"===$.type(settings.timeFormat)&&settings.show2400&&(end=_ONE_DAY);var dr=settings.disableTimeRanges,drCur=0,drLen=dr.length,stepFunc=settings.step;"function"!=typeof stepFunc&&(stepFunc=function(){return settings.step});for(var i=start,j=0;end>=i;j++,i+=60*stepFunc(j)){var timeInt=i,timeString=_int2time(timeInt,settings);if(settings.useSelect){var row=$("<option />",{value:timeString});row.text(timeString)}else{var row=$("<li />");row.data("time",86400>=timeInt?timeInt:timeInt%86400),row.text(timeString)}if((null!==settings.minTime||null!==settings.durationTime)&&settings.showDuration){var durationString=_int2duration(i-durStart,settings.step);if(settings.useSelect)row.text(row.text()+" ("+durationString+")");else{var duration=$("<span />",{"class":"ui-timepicker-duration"});duration.text(" ("+durationString+")"),row.append(duration)}}drLen>drCur&&(timeInt>=dr[drCur][1]&&(drCur+=1),dr[drCur]&&timeInt>=dr[drCur][0]&&timeInt<dr[drCur][1]&&(settings.useSelect?row.prop("disabled",!0):row.addClass("ui-timepicker-disabled"))),list.append(row)}if(wrapped_list.data("timepicker-input",self),self.data("timepicker-list",wrapped_list),settings.useSelect)self.val()&&list.val(_roundAndFormatTime(_time2int(self.val()),settings)),list.on("focus",function(){$(this).data("timepicker-input").trigger("showTimepicker")}),list.on("blur",function(){$(this).data("timepicker-input").trigger("hideTimepicker")}),list.on("change",function(){_setTimeValue(self,$(this).val(),"select")}),_setTimeValue(self,list.val(),"initial"),self.hide().after(list);else{var appendTo=settings.appendTo;"string"==typeof appendTo?appendTo=$(appendTo):"function"==typeof appendTo&&(appendTo=appendTo(self)),appendTo.append(wrapped_list),_setSelected(self,list),list.on("mousedown","li",function(e){self.off("focus.timepicker"),self.on("focus.timepicker-ie-hack",function(){self.off("focus.timepicker-ie-hack"),self.on("focus.timepicker",methods.show)}),_hideKeyboard(self)||self[0].focus(),list.find("li").removeClass("ui-timepicker-selected"),$(this).addClass("ui-timepicker-selected"),_selectValue(self)&&(self.trigger("hideTimepicker"),list.on("mouseup.timepicker","li",function(e){list.off("mouseup.timepicker"),wrapped_list.hide()}))})}}function _generateNoneElement(optionValue,useSelect){var label,className,value;return"object"==typeof optionValue?(label=optionValue.label,className=optionValue.className,value=optionValue.value):"string"==typeof optionValue?label=optionValue:$.error("Invalid noneOption value"),useSelect?$("<option />",{value:value,"class":className,text:label}):$("<li />",{"class":className,text:label}).data("time",value)}function _roundAndFormatTime(seconds,settings){return seconds=settings.roundingFunction(seconds,settings),null!==seconds?_int2time(seconds,settings):void 0}function _generateBaseDate(){return new Date(1970,1,1,0,0,0)}function _closeHandler(e){var target=$(e.target),input=target.closest(".ui-timepicker-input");0===input.length&&0===target.closest(".ui-timepicker-wrapper").length&&(methods.hide(),$(document).unbind(".ui-timepicker"),$(window).unbind(".ui-timepicker"))}function _hideKeyboard(self){var settings=self.data("timepicker-settings");return(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&settings.disableTouchKeyboard}function _findRow(self,list,value){if(!value&&0!==value)return!1;var settings=self.data("timepicker-settings"),out=!1,value=settings.roundingFunction(value,settings);return list.find("li").each(function(i,obj){var jObj=$(obj);if("number"==typeof jObj.data("time"))return jObj.data("time")==value?(out=jObj,!1):void 0}),out}function _setSelected(self,list){list.find("li").removeClass("ui-timepicker-selected");var timeValue=_time2int(_getTimeValue(self),self.data("timepicker-settings"));if(null!==timeValue){var selected=_findRow(self,list,timeValue);if(selected){var topDelta=selected.offset().top-list.offset().top;(topDelta+selected.outerHeight()>list.outerHeight()||0>topDelta)&&list.scrollTop(list.scrollTop()+selected.position().top-selected.outerHeight()),selected.addClass("ui-timepicker-selected")}}}function _formatValue(e,origin){if(""!==this.value&&"timepicker"!=origin){var self=$(this);if(!self.is(":focus")||e&&"change"==e.type){var settings=self.data("timepicker-settings"),seconds=_time2int(this.value,settings);if(null===seconds)return void self.trigger("timeFormatError");var rangeError=!1;null!==settings.minTime&&seconds<settings.minTime?rangeError=!0:null!==settings.maxTime&&seconds>settings.maxTime&&(rangeError=!0),$.each(settings.disableTimeRanges,function(){return seconds>=this[0]&&seconds<this[1]?(rangeError=!0,!1):void 0}),settings.forceRoundTime&&(seconds=settings.roundingFunction(seconds,settings));var prettyTime=_int2time(seconds,settings);rangeError?_setTimeValue(self,prettyTime,"error")&&self.trigger("timeRangeError"):_setTimeValue(self,prettyTime)}}}function _getTimeValue(self){return self.is("input")?self.val():self.data("ui-timepicker-value")}function _setTimeValue(self,value,source){if(self.is("input")){self.val(value);var settings=self.data("timepicker-settings");settings.useSelect&&"select"!=source&&"initial"!=source&&self.data("timepicker-list").val(_roundAndFormatTime(_time2int(value),settings))}return self.data("ui-timepicker-value")!=value?(self.data("ui-timepicker-value",value),"select"==source?self.trigger("selectTime").trigger("changeTime").trigger("change","timepicker"):"error"!=source&&self.trigger("changeTime"),!0):(self.trigger("selectTime"),!1)}function _keydownhandler(e){var self=$(this),list=self.data("timepicker-list");if(!list||!_isVisible(list)){if(40!=e.keyCode)return!0;methods.show.call(self.get(0)),list=self.data("timepicker-list"),_hideKeyboard(self)||self.focus()}switch(e.keyCode){case 13:return _selectValue(self)&&methods.hide.apply(this),e.preventDefault(),!1;case 38:var selected=list.find(".ui-timepicker-selected");return selected.length?selected.is(":first-child")||(selected.removeClass("ui-timepicker-selected"),selected.prev().addClass("ui-timepicker-selected"),selected.prev().position().top<selected.outerHeight()&&list.scrollTop(list.scrollTop()-selected.outerHeight())):(list.find("li").each(function(i,obj){return $(obj).position().top>0?(selected=$(obj),!1):void 0}),selected.addClass("ui-timepicker-selected")),!1;case 40:return selected=list.find(".ui-timepicker-selected"),0===selected.length?(list.find("li").each(function(i,obj){return $(obj).position().top>0?(selected=$(obj),!1):void 0}),selected.addClass("ui-timepicker-selected")):selected.is(":last-child")||(selected.removeClass("ui-timepicker-selected"),selected.next().addClass("ui-timepicker-selected"),selected.next().position().top+2*selected.outerHeight()>list.outerHeight()&&list.scrollTop(list.scrollTop()+selected.outerHeight())),!1;case 27:list.find("li").removeClass("ui-timepicker-selected"),methods.hide();break;case 9:methods.hide();break;default:return!0}}function _keyuphandler(e){var self=$(this),list=self.data("timepicker-list"),settings=self.data("timepicker-settings");if(!list||!_isVisible(list)||settings.disableTextInput)return!0;switch(e.keyCode){case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 65:case 77:case 80:case 186:case 8:case 46:settings.typeaheadHighlight?_setSelected(self,list):list.hide()}}function _selectValue(self){var settings=self.data("timepicker-settings"),list=self.data("timepicker-list"),timeValue=null,cursor=list.find(".ui-timepicker-selected");return cursor.hasClass("ui-timepicker-disabled")?!1:(cursor.length&&(timeValue=cursor.data("time")),null!==timeValue&&("string"!=typeof timeValue&&(timeValue=_int2time(timeValue,settings)),_setTimeValue(self,timeValue,"select")),!0)}function _int2duration(seconds,step){seconds=Math.abs(seconds);var hours,mins,minutes=Math.round(seconds/60),duration=[];return 60>minutes?duration=[minutes,_lang.mins]:(hours=Math.floor(minutes/60),mins=minutes%60,30==step&&30==mins&&(hours+=_lang.decimal+5),duration.push(hours),duration.push(1==hours?_lang.hr:_lang.hrs),30!=step&&mins&&(duration.push(mins),duration.push(_lang.mins))),duration.join(" ")}function _int2time(seconds,settings){if(null===seconds)return null;var time=new Date(_baseDate.valueOf()+1e3*seconds);if(isNaN(time.getTime()))return null;if("function"===$.type(settings.timeFormat))return settings.timeFormat(time);for(var hour,code,output="",i=0;i<settings.timeFormat.length;i++)switch(code=settings.timeFormat.charAt(i)){case"a":output+=time.getHours()>11?_lang.pm:_lang.am;break;case"A":output+=time.getHours()>11?_lang.PM:_lang.AM;break;case"g":hour=time.getHours()%12,output+=0===hour?"12":hour;break;case"G":hour=time.getHours(),seconds===_ONE_DAY&&(hour=24),output+=hour;break;case"h":hour=time.getHours()%12,0!==hour&&10>hour&&(hour="0"+hour),output+=0===hour?"12":hour;break;case"H":hour=time.getHours(),seconds===_ONE_DAY&&(hour=settings.show2400?24:0),output+=hour>9?hour:"0"+hour;break;case"i":var minutes=time.getMinutes();output+=minutes>9?minutes:"0"+minutes;break;case"s":seconds=time.getSeconds(),output+=seconds>9?seconds:"0"+seconds;break;case"\\":i++,output+=settings.timeFormat.charAt(i);break;default:output+=code}return output}function _time2int(timeString,settings){if(""===timeString)return null;if(!timeString||timeString+0==timeString)return timeString;if("object"==typeof timeString)return 3600*timeString.getHours()+60*timeString.getMinutes()+timeString.getSeconds();timeString=timeString.toLowerCase().replace(/[\s\.]/g,""),("a"==timeString.slice(-1)||"p"==timeString.slice(-1))&&(timeString+="m");var ampmRegex="("+_lang.am.replace(".","")+"|"+_lang.pm.replace(".","")+"|"+_lang.AM.replace(".","")+"|"+_lang.PM.replace(".","")+")?",pattern=new RegExp("^"+ampmRegex+"([0-2]?[0-9])\\W?([0-5][0-9])?\\W?([0-5][0-9])?"+ampmRegex+"$"),time=timeString.match(pattern);if(!time)return null;var hour=parseInt(1*time[2],10),ampm=time[1]||time[5],hours=hour;if(12>=hour&&ampm){var isPm=ampm==_lang.pm||ampm==_lang.PM;hours=12==hour?isPm?12:0:hour+(isPm?12:0)}var minutes=1*time[3]||0,seconds=1*time[4]||0,timeInt=3600*hours+60*minutes+seconds;if(12>hour&&!ampm&&settings&&settings._twelveHourTime&&settings.scrollDefault){var delta=timeInt-settings.scrollDefault();0>delta&&delta>=_ONE_DAY/-2&&(timeInt=(timeInt+_ONE_DAY/2)%_ONE_DAY)}return timeInt}var _baseDate=_generateBaseDate(),_ONE_DAY=86400,_lang={am:"am",pm:"pm",AM:"AM",PM:"PM",decimal:".",mins:"mins",hr:"hr",hrs:"hrs"},methods={init:function(options){return this.each(function(){var self=$(this),attributeOptions=[];for(var key in $.fn.timepicker.defaults)self.data(key)&&(attributeOptions[key]=self.data(key));var settings=$.extend({},$.fn.timepicker.defaults,attributeOptions,options);if(settings.lang&&(_lang=$.extend(_lang,settings.lang)),settings=_parseSettings(settings),self.data("timepicker-settings",settings),self.addClass("ui-timepicker-input"),settings.useSelect)_render(self);else{if(self.prop("autocomplete","off"),settings.showOn)for(i in settings.showOn)self.on(settings.showOn[i]+".timepicker",methods.show);self.on("change.timepicker",_formatValue),self.on("keydown.timepicker",_keydownhandler),self.on("keyup.timepicker",_keyuphandler),settings.disableTextInput&&self.on("keypress.timepicker",function(e){e.preventDefault()}),_formatValue.call(self.get(0))}})},show:function(e){var self=$(this),settings=self.data("timepicker-settings");if(e&&e.preventDefault(),settings.useSelect)return void self.data("timepicker-list").focus();_hideKeyboard(self)&&self.blur();var list=self.data("timepicker-list");if(!self.prop("readonly")&&(list&&0!==list.length&&"function"!=typeof settings.durationTime||(_render(self),list=self.data("timepicker-list")),!_isVisible(list))){self.data("ui-timepicker-value",self.val()),_setSelected(self,list),methods.hide(),list.show();var listOffset={};settings.orientation.match(/r/)?listOffset.left=self.offset().left+self.outerWidth()-list.outerWidth()+parseInt(list.css("marginLeft").replace("px",""),10):listOffset.left=self.offset().left+parseInt(list.css("marginLeft").replace("px",""),10);var verticalOrientation;verticalOrientation=settings.orientation.match(/t/)?"t":settings.orientation.match(/b/)?"b":self.offset().top+self.outerHeight(!0)+list.outerHeight()>$(window).height()+$(window).scrollTop()?"t":"b","t"==verticalOrientation?(list.addClass("ui-timepicker-positioned-top"),listOffset.top=self.offset().top-list.outerHeight()+parseInt(list.css("marginTop").replace("px",""),10)):(list.removeClass("ui-timepicker-positioned-top"),listOffset.top=self.offset().top+self.outerHeight()+parseInt(list.css("marginTop").replace("px",""),10)),list.offset(listOffset);var selected=list.find(".ui-timepicker-selected");if(!selected.length){var timeInt=_time2int(_getTimeValue(self));null!==timeInt?selected=_findRow(self,list,timeInt):settings.scrollDefault&&(selected=_findRow(self,list,settings.scrollDefault()))}if(selected&&selected.length){var topOffset=list.scrollTop()+selected.position().top-selected.outerHeight();list.scrollTop(topOffset)}else list.scrollTop(0);return settings.stopScrollPropagation&&$(document).on("wheel.ui-timepicker",".ui-timepicker-wrapper",function(e){e.preventDefault();var currentScroll=$(this).scrollTop();$(this).scrollTop(currentScroll+e.originalEvent.deltaY)}),$(document).on("touchstart.ui-timepicker mousedown.ui-timepicker",_closeHandler),$(window).on("resize.ui-timepicker",_closeHandler),settings.closeOnWindowScroll&&$(document).on("scroll.ui-timepicker",_closeHandler),self.trigger("showTimepicker"),this}},hide:function(e){var self=$(this),settings=self.data("timepicker-settings");return settings&&settings.useSelect&&self.blur(),$(".ui-timepicker-wrapper").each(function(){var list=$(this);if(_isVisible(list)){var self=list.data("timepicker-input"),settings=self.data("timepicker-settings");settings&&settings.selectOnBlur&&_selectValue(self),list.hide(),self.trigger("hideTimepicker")}}),this},option:function(key,value){return this.each(function(){var self=$(this),settings=self.data("timepicker-settings"),list=self.data("timepicker-list");if("object"==typeof key)settings=$.extend(settings,key);else if("string"==typeof key&&"undefined"!=typeof value)settings[key]=value;else if("string"==typeof key)return settings[key];settings=_parseSettings(settings),self.data("timepicker-settings",settings),list&&(list.remove(),self.data("timepicker-list",!1)),settings.useSelect&&_render(self)})},getSecondsFromMidnight:function(){return _time2int(_getTimeValue(this))},getTime:function(relative_date){var self=this,time_string=_getTimeValue(self);if(!time_string)return null;var offset=_time2int(time_string);if(null===offset)return null;relative_date||(relative_date=_baseDate);var time=new Date(relative_date);return time.setHours(offset/3600),time.setMinutes(offset%3600/60),time.setSeconds(offset%60),time.setMilliseconds(0),time},setTime:function(value){var self=this,settings=self.data("timepicker-settings");if(settings.forceRoundTime)var prettyTime=_roundAndFormatTime(_time2int(value),settings);else var prettyTime=_int2time(_time2int(value),settings);return value&&null===prettyTime&&settings.noneOption&&(prettyTime=value),_setTimeValue(self,prettyTime),self.data("timepicker-list")&&_setSelected(self,self.data("timepicker-list")),this},remove:function(){var self=this;if(self.hasClass("ui-timepicker-input")){var settings=self.data("timepicker-settings");return self.removeAttr("autocomplete","off"),self.removeClass("ui-timepicker-input"),self.removeData("timepicker-settings"),self.off(".timepicker"),self.data("timepicker-list")&&self.data("timepicker-list").remove(),settings.useSelect&&self.show(),self.removeData("timepicker-list"),this}}};$.fn.timepicker=function(method){return this.length?methods[method]?this.hasClass("ui-timepicker-input")?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):this:"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.timepicker"):methods.init.apply(this,arguments):this},$.fn.timepicker.defaults={appendTo:"body",className:null,closeOnWindowScroll:!1,disableTextInput:!1,disableTimeRanges:[],disableTouchKeyboard:!1,durationTime:null,forceRoundTime:!1,maxTime:null,minTime:null,noneOption:!1,orientation:"l",roundingFunction:function(seconds,settings){if(null===seconds)return null;var offset=seconds%(60*settings.step);return offset>=30*settings.step?seconds+=60*settings.step-offset:seconds-=offset,seconds},scrollDefault:null,selectOnBlur:!1,show2400:!1,showDuration:!1,showOn:["click","focus"],showOnFocus:!0,step:30,stopScrollPropagation:!1,timeFormat:"g:ia",typeaheadHighlight:!0,useSelect:!1}});